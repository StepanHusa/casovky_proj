---
title: "Projekt do předmětu Časové řady I"
author: "Michal Červenka, Martin Heger, Štěpán Husa"
date: "2025-12-15"
lang: cs
format:
  html:
    theme: default
    toc: true
    toc-depth: 3
    toc-title: "Obsah"
    code-fold: true
code-tools: true
embed-resources: true
fig-cap: true
execute:
  echo: true
  warning: false
  message: false
---

# Úvod

## 1. Načtení knihoven

```{r}
#| label: knihovny
#| echo: true

# Načtení potřebných balíčků
if (!require(forecast)) install.packages("forecast", repos = "https://cloud.r-project.org")
if (!require(zoo)) install.packages("zoo")
if (!require(readr)) install.packages("readr", repos = "https://cloud.r-project.org")
if (!require(tseries)) install.packages("tseries", repos = "https://cloud.r-project.org")
library(readr)
library(zoo)
library(forecast)
library(tseries)
library(ggplot2)
library(dplyr)
library(tseries)
```

## 2. Načtení dat

```{r}
#| label: data
#| echo: true

# Načtení datasetu
data <- read_csv("MLTollsStackOverflow.csv")
head(data[c("month", "python", "r")])
```


## 3. Popis dat

Použitý dataset obsahuje měsíční počty dotazů na StackOverflow od roku 2009 do roku 2020 pro různé programovací knihovny a technologie. Pro účely této analýzy se zaměřujeme pouze na dvě proměnné – Python a R, které reprezentují počet dotazů souvisejících s těmito jazyky v jednotlivých měsících.

Nejprve jsme si zobrazili několik prvních pozorování datasetu, abychom se seznámili se strukturou dat a ověřili, že hodnoty odpovídají očekávanému formátu. Následně jsme vypočítali základní popisné statistiky pro obě časové řady.

### Popisné statistiky - Python & R
```{r}
#| label: popis-dat
#| echo: true

# Popisné statistiky
summary(data[, c("python", "r")])
```

- Minimální počet dotazů je výrazně vyšší u Pythonu než u R.
- Medián i průměr jsou u Pythonu několikanásobně vyšší než u R, což naznačuje dlouhodobě větší popularitu Pythonu.
- Rozptyl hodnot je u Pythonu rovněž vyšší, což souvisí s rychlejším růstem zájmu v čase.
- Maximální hodnoty ukazují, že Python dosahuje až téměř 24 000 dotazů za měsíc, zatímco R přibližně 5 100.

---

# Analýza

## 1. Předběžný výzkum časové řady

### Grafické zobrazení časových řad

#### Python

```{r}
#| label: vyzkum
#| echo: true

# Vytvoření časové řady: Python
python_ts <- ts(data$python,
                start = c(2009, 1),
                frequency = 12)

# Vytvoření časové řady: R
r_ts <- ts(data$r,
           start = c(2009, 1),
           frequency = 12)

# Graf: Python
plot(python_ts,
     main = "StackOverflow: dotazy k Pythonu",
     ylab = "počet dotazů za měsíc",
     xlab = "rok")
```

- Jasný rostoucí trend od roku 2009 do 2020.
- Postupem času narůstá i variabilita počtu dotazů.
- Viditelné pravidelné sezónní kolísání.

#### R

```{r}
#| label: vyzkum_R
#| echo: true
# Graf: R
plot(r_ts,
     main = "StackOverflow: dotazy k R",
     ylab = "počet dotazů za měsíc",
     xlab = "rok")
```

- Trend také roste, ale pomaleji a méně výrazně než u Pythonu.
- Amplituda sezónnosti je menší.
- Po roce 2017 se růst zpomaluje.

#### Společný graf

```{r}
#| label: vyzkum_spolecny
#| echo: true

# Společný graf
par(mfrow = c(1,1))


ts.plot(cbind(python_ts, r_ts),
        col = c("blue", "red"),
        lty = 1:2,
        main = "Python vs R",
        ylab = "Počet dotazů za měsíc")

legend("topleft",
       legend = c("Python", "R"),
       col = c("blue", "red"),
       lty = 1:2,
       bty = "n")
```

- Python má výrazně větší počet dotazů a rychleji roste.
- Od roku ~2014 se rozdíl ještě zvětšuje.
- Oba jazyky mají podobný vzor sezónnosti.

### Aditivní dekompozice

#### Python

```{r}
#| label: vyzkum_3
#| echo: true

# Additivní dekompozice

## Python
decomp_python <- decompose(python_ts, type = "additive")
plot(decomp_python)
```

- **Trend**: silně rostoucí, plynulý.
- **Sezónnost**: pravidelná, opakující se ročně.
- **Remainder**: náhodné fluktuace bez jasné struktury.

#### R

```{r}
#| label: vyzkum_4
#| echo: true
## R
stl_r <- stl(r_ts, s.window = "periodic")
plot(stl_r)
```

- **Trend**: roste, ale méně než Python; kolem 2017 mírné zpomalení.
- **Sezónnost**: také pravidelná a stabilní.
- **Remainder**: náhodný šum bez výrazných anomálií.

## 2. Testování stacionarity

### Python

```{r}
#| label: stacionarita_python
#| echo: true
adf_python <- adf.test(python_ts)
adf_python
```

### R

```{r}
#| label: stacionarita_r
#| echo: true
adf_r <- adf.test(r_ts)
adf_r
```

### Python - diference

```{r}
#| label: stacionarita_python_diff
#| echo: true
adf_python_diff <- adf.test(diff(python_ts))
adf_python_diff
```

### R - diference

```{r}
#| label: stacionarita_r_diff
#| echo: true
adf_r_diff  <- adf.test(diff(r_ts))
adf_r_diff
```

**Shrnutí**:

- Obě časové řady jsou nestacionární v původní podobě.
- Důvodem je především rostoucí trend a možná sezónnost.
- Obě řady se stávají stacionární po jedné diferenci.
- Pro modelování ARIMA bude nutné řady diferencovat (parametr d = 1).

## 3. Autokorelace a parciální autokorelace

### Python

```{r}
#| label: acf-pacf_python
#| echo: true

par(mfrow = c(2,2))

acf(python_ts, main = "ACF – Python")
pacf(python_ts, main = "PACF – Python")

acf(diff(python_ts), main = "ACF – diff(Python)")
pacf(diff(python_ts), main = "PACF – diff(Python)")
```


### R

```{r}
#| label: acf-pacf_R
#| echo: true

par(mfrow = c(2,2))

acf(r_ts, main = "ACF – R")
pacf(r_ts, main = "PACF – R")

acf(diff(r_ts), main = "ACF – diff(R)")
pacf(diff(r_ts), main = "PACF – diff(R)")
```

- Trend také roste, ale pomaleji a méně výrazně než u Pythonu.
- Amplituda sezónnosti je menší.
- Po roce 2017 se růst zpomaluje.

**Shrnutí**:

- Původní řada: ACF pomalu klesá → nestacionární, potvrzuje trend.
- Po diferenciaci: ACF má výrazný lag 1, PACF také → vhodné modely ARIMA(1,1,1) nebo blízké alternativy.


## 4. Výběr vhodných modelů

```{r}
#| label: modely-vyber
#| echo: true

# auto.arima(ts_data)
# sarima_model <- auto.arima(ts_data, seasonal = TRUE)
```

## 5. Odhad modelů (AR, ARMA, ARIMA, SARIMA)

```{r}
#| label: modely-odhad
#| echo: true

# ar_model <- ar(ts_data)
# arma_model <- arima(ts_data, order = c(1,0,1))
# sarima_model <- arima(ts_data, order = c(1,1,1), seasonal = c(1,1,1))
```

## 6. Diagnostika modelů

```{r}
#| label: diagnostika
#| echo: true

# checkresiduals(arma_model)
# tsdiag(arma_model)
```

## 7. Predikce

```{r}
#| label: predikce
#| echo: true

# forecast_arma <- forecast(arma_model, h = 12)
# autoplot(forecast_arma)
```

---

# Závěr

## 1. Shrnutí výsledků

- Shrnutí chování původní i transformované řady.
- Porovnání přesnosti modelů (AIC, BIC, RMSE).
- Vyhodnocení nejvhodnějšího modelu podle predikční schopnosti.

## 2. Diskuze

- Omezení modelu.
- Možnosti vylepšení (delší řada, jiná frekvence, jiné transformace).

## Závěrečné poznámky

Projekt ukazuje postup od přípravy dat až po modelování a predikci pomocí metod ARIMA a jejich variant.

